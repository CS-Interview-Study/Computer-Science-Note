# 멀티프로세싱

- 여러 개의 프로세스, 동시에 두 가지 이상의 일을 수행할 수 있는 것
- 하나 이상의 일을 병렬적 처리, 프로세스 중 일부에 문제가 있더라도 다른 프로세스를 이용해 처리 할 수 있음

### 웹 브라우저의 멀티프로세스 구조

- 브라우저 프로세스: 주소 표시줄, 북마크 막대, 뒤로 가기 버튼 등 및 네트워크 요청이나 파일 접근 권한 등 담당
- 렌더러 프로세스 : ‘보이는’부분 의 모든 것 제어, 멀티스레드로 구성
    - 메인스레드
    - 워커 스레드
    - 컴포지터 스레드
    - 레스터 스레드
- 플러그인 프로세스: 사용하는 플러그인 제어
- GPU 프로세스 : GPU 이용해 화면 그리는 부분 제어

### IPC(Inter Process Communication)

⇒ 프로세스끼리 데이터를 주고받고 공유 데이터를 관리하는 매커니즘

메모리가 완전히 공유되는 스레드보다 속도가 느림

1. 공유메모리(shared memory)

여러 프로세스에 동일한 메모리 블록에 대한 접근 권한 부여

⇒ 프로세스가 서로 통신할 수 있게 공유 버퍼 생성

- 기본적으로 각 프로세스의 메모리를 다른 프로세스가 접근 X
- 여러 프로세스가 하나의 메모리 공유
- 메모리 자체를 공유하기에 불필요한 데이터 복사의 오버헤드 발생X , IPC 중 가장 빠름
- 가장 빠르며, 여러 프로세스가 하나의 메모리를 공유하므로 **동기화** 필요
- 프로세스 간 Read, Write 모두 필요 시 사용

cf ) 하드웨어 관점에서 공유메모리란? 

CPU가 접근할 수 있는 RAM을 가리키기도 함

1. 파일
    
    디스크에 저장된 데이터 or 파일 서버에서 제공한 데이터
    
    이를 기반으로 프로세스 간 통신함
    
2. 소켓
    - 같은 컴퓨터 내 다른 프로세스나 다른 컴퓨터로 네트워크 인터페이스를 통해 전송하는 데이터
    - 동일한 호스트 운영 체제에세 실행되는 프로세스간 데이터를 교환하기 위한 데이터 통신 엔드 포인트
    - 데이터 교환을 위해 임의의 포트를 각각 정하고 포트 간의 대화를 통해 데이터 주고 받음
    
    cf ) TCP, UDP
    
3. 익명 파이프(unamed, anonymous pipe)
    
    프로세스 간에 FIFO 방식으로 읽히는 임시공간인 파이프를 기반으로 데이터를 송수신
    
    - 단방향 방식의 읽기 전용, 쓰기 전용 파이프를 만들어 작동하는 방식
    - 부모, 자식 프로세스 간에만 사용가능, 다른 네트워크상에서는 사용 불가능
    
4. 명명된 or 네임드 파이(named pipe)
    
    파이프 서버와 하나 이상의 파이프 클라이언트 간의 통신을 위한 명명된 단뱡향 or 이중 파이브
    
    - 클라이언트/서버 통신을 위한 별도의 파이프 제공, 여러 파이프 동시에 사용 가능
    - 컴퓨터의 프로세스끼리, 다른 네트워크상 컴퓨터와도 통신 가능
    - 서버용 파이프와 클라이언트용 파이프로 구분해서 작동
    - 하나의 인스턴스를 열거나 여러 개의 인스턴스를 기반으로 통신
    
5. 메세지 큐
    
    메세지를 큐(queue) 데이터 구조형태로 관리
    
    - 커널에서 전역적으로 관리, 다른 IPC방식에 비해 사용 방법이 직관적이고 간단
    - 입출력 방식은 named pipe와 동일
    - 파이프처럼 데이터의 흐름이 아니라 메모리 공간
    - 다수의 프로세스 간 메세지를 전달 할 수 있음
    - 메세지 접근을 위해서는 key가 필요
    
    # 스레드와 멀티스레딩
    
    ## 스레드
    
    프로세스의 실행 가능한 가장 작은 단위
    
    - 프로세스
        
        코드, 데이터, 스택, 힙 각각 생성
        
    
    - 멀티스레드 기반 프로세스
        
        코드, 데이터, 힙 ⇒ 스레드 끼리 공유
        
        스택 각각 생성
        
    
    ## 멀티스레딩
    
    프로세스 내 작업을 여러 개의 스레드, 멀티스레드로 처리하는 기법
    
    ⇒ 스레드끼리 서로 자원 공유하므로 효율성 높음, 동시성
    
    - 단점) 한 스레드에 문제가 생기면 다른 스레드에 영향을 끼쳐 프로세스에 영향을 줄 수 있음
    
    cf ) 웹 요청 처리시 스레드를 사용하는 웹 서버
    
    - 적은 리소스 소비
    - 한 스레드가 block되어도 다른 스레드는 runnung 상태 일수 있기에 중단되지 않은 채 빠른 처리 가능
