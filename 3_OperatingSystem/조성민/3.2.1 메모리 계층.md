# 구성

- 레지스터
    - CPU 안에 있는 작은 메모리
    - 휘발성
    - 가장 빠른 속도
    - 가장 작은 기억 용량
- 캐시
    - L1, L2 캐시를 지칭 (L3도 있음)
    - 휘발성
    - 속도 빠름
    - 작은 기억 용량
- 주기억장치
    - RAM을 지칭
    - 휘발성
    - 속도 보통
    - 보통의 기억 용량
- 보조기억장치
    - HDD, SSD를 지칭
    - 비휘발성
    - 속도 낮음
    - 많은 기억 용량

- RAM
    - 보조기억장치로부터 일정량의 데이터를 복사해서 임시 저장하고 이를 필요 시마다 CPU에 빠르게 전달한다.

구성이 나뉘어져 있는 이유는 경제성과 캐시 때문이다.

# 캐시

- 데이터를 미리 복사해 놓는 임시 저장소
- 빠른 장치와 느린 장치의 속도 차이에 따른 병목 현상을 줄이기 위한 메모리
- 데이터에 접근하는 시간, 같은 계산을 다시 하는 시간을 줄인다.

- 캐시 계층
    - 속도 차이를 해결하기 위해 계층과 계층 사이에 존재하는 계층

## 지역성의 원리

캐시 계층을 두지 않고 직접 캐시를 설정할 때 자주 사용하는 데이터를 기반으로 설정한다.

자주 사용하는 데이터의 근거가 지역성이다.

### 시간 지역성

최근 사용한 데이터에 다시 접근하려는 특성

### 공간 지역성

최근 접근한 데이터를 이루고 있는 공간이나 가까운 공간에 접근하려는 특성

# 캐시히트와 캐시미스

- 캐시히트
    - 캐시에서 원하는 데이터를 찾은 것
    - 제어장치를 거쳐 데이터를 가져온다.
    - 위치도 가깝고 CPU 내부 버스를 기반으로 작동하기 때문에 빠르다.
- 캐시미스
    - 캐시에서 원하는 데이터가 없어서 찾지 못하고 주 메모리로 가서 데이터를 찾아오는 것
    - 시스템 버스 기반으로 작동하기 때문에 느리다.

## 캐시매핑

캐시 히트를 위해 매핑하는 방법

- 직접 매핑
    - 캐시가 1~10, 메모리가 1~100이 있다면, 캐시 1에 메모리 1~10, 캐시 2에 메모리 11~20 … 이런 식으로 저장
    - 구현이 간단하다.
    - 처리가 빠르다.
    - 비효율적이다.
    - 수정에 취약하다.
    - 충돌이 잦다.
- 연관 매핑
    - 순서를 일치시키지 않고 관련있는 메모리끼리 캐시에 저장한다.
    - 충돌이 적다.
    - 모든 블록을 탐색해야 해서 느리다.
- 집합 연관 매핑
    - 직접 매핑 + 연관 매핑
    - 순서를 일치시키고 일정 그룹을 두어 저장
    - 캐시가 1~10, 메모리가 1~100이 있다면, 캐시 1~5에 메모리 1~50을 무작위로 저장한다.
    - 연관 매핑보다 탐색이 빠르다.

## 웹 브라우저의 캐시

### 쿠키

- 만료 기한이 있는 키-값 저장소
- same site 옵션을 strict로 설정하지 않았을 경우 다른 도메인에서 요청했을 때 자동 전송된다.
- 4KB까지 데이터를 저장할 수 있다.
- document.cookie로 쿠키를 볼 수 없게 httponly 옵션을 걸어야한다.
- 클라이언트, 서버에서 만료 기한을 정할 수 있다. 보통 서버에서 정한다.

### 로컬 스토리지

- 만료 기한이 없는 키-값 저장소
- 5MB까지 저장할 수 있다.
- 웹 브라우저를 닫아도 유지된다.
- HTML5를 지원하지 않는 웹 브라우저에서는 사용할 수 없다.
- 클라이언트에서만 수정 가능하다.

### 세션 스토리지

- 만료 기한이 없는 키-값 저장소
- 탭 단위로 생성
- 탭을 닫으면 데이터가 삭제된다.
- 5MB까지 저장할 수 있다.
- HTML5를 지원하지 않는 웹 브라우저에서는 사용할 수 없다.
- 클라이언트에서만 수정 가능하다.
