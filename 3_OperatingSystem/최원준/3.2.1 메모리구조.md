---
description: 메모리 계층
---

# 3.2.1 Memory Hierarchy

컴퓨터 시스템에서 메모리는 CPU가 명령어를 실행하는데 필수적인 요소입니다. 메모리는 다양한 계층으로 구성되어 있으며, 각 계층은 속도와 용량, 비용 면에서 차이를 보입니다.



## 1. 메모리 계층의 개념

메모리 계층은 레지스터, 캐시, 메모리, 저장장치로 구성되어 있습니다. 각 계층은 속도와 용량 면에서 차이를 보이며, CPU와 가까운 순서대로 배치됩니다.



## 2. 메모리 계층의 구성

### **2.1 레지스터**

레지스터는 CPU 내에 있는 작은 메모리로, 속도가 가장 빠릅니다. 레지스터는 CPU가 직접 명령어를 실행하는데 사용되며, 메모리 계층 중 용량이 가장 작습니다. 레지스터는 주로 임시 데이터를 저장하고, 연산에 필요한 데이터를 빠르게 접근할 수 있도록 합니다.

* **속도**: 매우 빠름
* **용량**: 매우 작음
* **예시**: CPU 레지스터 (프로그램 카운터, 스택 포인터 등)

### **2.2 캐시(Cache)**

캐시는 데이터와 명령어를 임시로 저장하여 CPU가 빠르게 접근할 수 있도록 하는 메모리입니다. 캐시는 L1, L2, L3 캐시로 나뉘며, 각 계층은 CPU와의 거리, 속도, 용량 면에서 차이를 보입니다. 캐시는 자주 사용되는 데이터를 미리 저장하여 메모리에 접근하는 시간을 줄이고, 시스템 성능을 향상시킵니다.

* **L1 캐시**: CPU에 가장 가까운 캐시로, 속도가 가장 빠르며 용량이 작습니다.
* **L2 캐시**: L1 캐시보다 용량이 크고, 속도는 느립니다.
* **L3 캐시**: 여러 CPU 코어가 공유하는 캐시로, 용량이 가장 크고, 속도는 가장 느립니다.
* **속도**: 레지스터보다 느림, 메모리보다 빠름
* **용량**: 레지스터보다 큼, 메모리보다 작음
* **예시**: L1, L2, L3 캐시

### **2.3 주기억장치(Main Memory)**

주기억장치는 RAM(Random Access Memory)으로 구성되며, 컴퓨터가 실행 중인 프로그램과 데이터를 저장합니다. 주기억장치는 CPU가 직접 접근할 수 있으며, 속도와 용량 면에서 캐시와 저장장치의 중간 정도입니다. 주기억장치는 휘발성 메모리로, 전원이 꺼지면 데이터가 사라집니다.

* **속도**: 캐시보다 느림, 저장장치보다 빠름
* **용량**: 캐시보다 큼, 저장장치보다 작음
* **예시**: DRAM(Dynamic RAM), SDRAM(Synchronous DRAM)

### **2.4 보조기억장치(Secondary Storage)**

보조기억장치는 하드 디스크 드라이브(HDD), 솔리드 스테이트 드라이브(SSD) 등으로 구성되며, 대용량 데이터를 영구적으로 저장합니다. 보조기억장치는 주기억장치보다 속도가 느리지만, 용량이 크고 데이터를 영구적으로 저장할 수 있습니다. HDD는 회전하는 디스크를 이용하여 데이터를 읽고 쓰며, SSD는 플래시 메모리를 이용하여 데이터를 저장합니다.

* **속도**: 가장 느림
* **용량**: 가장 큼
* **예시**: HDD, SSD

## 3. 메모리 계층의 원리

메모리 계층의 원리는 빠르고 작은 메모리와 느리고 큰 메모리를 조합하여 최적의 성능을 제공하는 것입니다. CPU는 가장 빠른 레지스터와 캐시를 우선적으로 사용하고, 필요한 데이터가 캐시에 없을 경우 주기억장치에서 데이터를 가져옵니다. 주기억장치에도 데이터가 없을 경우 보조기억장치에서 데이터를 가져옵니다.

이러한 구조는 CPU가 데이터를 처리하는 속도를 최적화하고, 비용 효율적인 메모리 사용을 가능하게 합니다.

#### **지역성의 원리**

메모리 계층에서 중요한 개념 중 하나는 '지역성의 원리'입니다. 이는 프로그램이 실행될 때 자주 사용되는 데이터가 공간적으로나 시간적으로 가까운 위치에 모여 있다는 원리입니다. 지역성의 원리는 시간 지역성과 공간 지역성으로 나눌 수 있습니다.

* **시간 지역성(Temporal Locality)**: 최근에 접근한 데이터에 다시 접근할 가능성이 높은 특성을 말합니다. 예를 들어, 반복문 내에서 사용되는 변수는 반복문이 실행되는 동안 자주 접근됩니다.
* **공간 지역성(Spatial Locality)**: 인접한 메모리 주소의 데이터에 접근할 가능성이 높은 특성을 말합니다. 예를 들어, 배열 요소에 접근할 때 인접한 요소들도 함께 접근될 가능성이 높습니다.

## 4. 캐시의 동작 원리

캐시는 메모리 계층의 중요한 구성 요소로, 데이터 접근 속도를 높이기 위해 자주 사용되는 데이터를 미리 저장합니다. 캐시의 동작 원리는 다음과 같습니다.

### **4.1 캐시 히트(Cache Hit)와 캐시 미스(Cache Miss)**

* **캐시 히트**: CPU가 필요한 데이터를 캐시에서 찾는 경우를 말합니다. 이 경우 데이터는 캐시에서 즉시 제공되어 빠른 속도로 처리됩니다.
* **캐시 미스**: CPU가 필요한 데이터를 캐시에서 찾지 못하는 경우를 말합니다. 이 경우 데이터는 주기억장치 또는 보조기억장치에서 가져와야 하며, 이로 인해 처리 속도가 느려질 수 있습니다.

### **4.2 캐시 매핑(Caching Mapping)**

캐시 매핑은 메모리 블록을 캐시에 배치하는 방법을 말합니다. 주요 캐시 매핑 기법으로는 직접 매핑(Direct Mapping), 연관 매핑(Associative Mapping), 집합 연관 매핑(Set-Associative Mapping) 등이 있습니다.

* **직접 매핑(Direct Mapping)**: 메모리 블록을 캐시의 특정 위치에 매핑하는 방식입니다. 매핑이 간단하고 빠르지만, 충돌이 발생할 가능성이 큽니다.
* **연관 매핑(Associative Mapping)**: 메모리 블록을 캐시의 어느 위치에나 매핑할 수 있는 방식입니다. 충돌 문제를 해결할 수 있지만, 매핑 과정이 복잡하고 비용이 높습니다.
* **집합 연관 매핑(Set-Associative Mapping)**: 직접 매핑과 연관 매핑의 혼합 방식으로, 메모리 블록을 특정 집합에 매핑할 수 있습니다. 충돌 문제를 줄이면서도 비교적 간단한 매핑을 제공합니다.

## 5. 캐시 계층의 예시

캐시 계층은 다양한 시스템에서 사용됩니다. 다음은 몇 가지 예시입니다.

### **5.1 웹 브라우저의 캐시**

웹 브라우저는 사용자가 방문한 웹 페이지의 데이터를 캐시에 저장하여, 동일한 페이지를 다시 방문할 때 빠르게 로드할 수 있도록 합니다. 웹 브라우저 캐시는 쿠키, 로컬 스토리지, 세션 스토리지 등의 방식으로 데이터를 저장합니다.

* **쿠키**: 작은 텍스트 파일로, 사용자의 정보를 저장합니다. 예를 들어, 로그인 상태를 유지하거나, 사용자 설정을 저장하는 데 사용됩니다.
* **로컬 스토리지**: 브라우저에 영구적으로 데이터를 저장하며, 세션이 끝나도 데이터가 유지됩니다.
* **세션 스토리지**: 브라우저 세션 동안 데이터를 저장하며, 세션이 끝나면 데이터가 삭제됩니다.

### **5.2 데이터베이스의 캐시**

데이터베이스는 자주 사용되는 쿼리 결과를 캐시에 저장하여, 동일한 쿼리를 실행할 때 빠르게 결과를 반환할 수 있도록 합니다. 예를 들어, Redis는 인메모리 데이터베이스로, 데이터를 메모리에 저장하여 빠른 속도로 접근할 수 있도록 합니다.

## 결론

메모리 계층은 컴퓨터 시스템에서 중요한 역할을 하며, 각 계층은 속도와 용량 면에서 차이를 보입니다. 레지스터, 캐시, 주기억장치, 보조기억장치는 각각의 특성과 역할이 있으며, 이들을 조합하여 최적의 성능을 제공합니다. 메모리 계층의 원리를 이해하면, 컴퓨터 시스템의 성능을 최적화하고 효율적으로 사용할 수 있습니다.
